import{c as f,u as N,r as d,a as y,j as e,F as w,D as S,b as C,B as x,d as k,e as P,X as M,f as D,g as F,h as I,i as E,S as V,k as L,l as T,m as O,n as A,o as G,p as q,q as j,s as z,A as R,I as B,t as Q,v as W,P as _}from"./index-DxBtr4UR.js";import{S as h,T as H,a as u}from"./item-Bh_p7c0B.js";import{L as U}from"./loader-CVlspoiJ.js";/**
 * @license lucide-react v0.383.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=f("ArrowDownUp",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"m21 8-4-4-4 4",key:"1c9v7m"}],["path",{d:"M17 4v16",key:"7dpous"}]]);/**
 * @license lucide-react v0.383.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=f("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);function g(){const[i,n]=N(),t=d.useMemo(()=>{const o={};return i.forEach((l,s)=>{o[s]=l}),o},[i]);return{pushQuery:o=>{const l={...o};for(const s in o)o[s]&&(l[s]=o[s]);n(l)},query:t}}const p=[{label:"Newest",value:"-createdAt"},{label:"Highest Priority",value:"-priority"},{label:"Lowest Priority",value:"priority"},{label:"Closest Deadline",value:"deadline"},{label:"Furthest Deadline",value:"-deadline"}];function J(){const{pushQuery:i,query:n}=g(),t=y({defaultValues:{status:(n.status||"").split("|"),sort:n.sort||p[0].value}}),c=t.watch("status"),o=d.useMemo(()=>h.filter(r=>c.includes(r.value)).map(r=>r.label).join(", "),[c]),l=()=>{const a={...t.getValues()};a.status=a.status.join("|"),i(a)},s=(a,r)=>{const m=t.getValues("status");a?t.setValue("status",[...m,r]):t.setValue("status",m.filter(b=>b!==r)),l()},v=()=>{t.setValue("status",[]),l()};return e.jsx(w,{...t,children:e.jsxs("form",{className:"w-full justify-between flex ",children:[e.jsxs(S,{children:[e.jsxs("div",{className:"flex items-center gap-x-2",children:[e.jsx(X,{strokeWidth:1.5,color:"#b9b9b9",className:"flex-shrink-0"}),e.jsx(C,{asChild:!0,children:e.jsx(x,{variant:"outline",className:"flex items-center gap-x-2 rounded-full w-[150px] justify-start",children:e.jsx("p",{className:"truncate",children:o||"Status"})})})]}),e.jsxs(k,{className:"w-56",children:[e.jsxs(P,{className:"flex items-center justify-between py-1",children:[e.jsx("p",{children:"Status"}),e.jsx(x,{type:"button",variant:"ghost",className:"p-0 h-fit",onClick:v,children:e.jsx(M,{strokeWidth:1.5,color:"#b9b9b9",size:20})})]}),e.jsx(D,{}),h.map(a=>e.jsx(F,{checked:c.includes(a.value),onCheckedChange:r=>s(r,a.value),className:"py-3 pl-8",children:e.jsxs("div",{className:"flex gap-x-2 items-center",children:[e.jsx("i",{children:a.icon}),e.jsx("p",{className:`font-medium !bg-transparent ${a.className}`,children:a.label})]})},a.value))]})]}),e.jsx(I,{control:t.control,name:"sort",render:({field:a})=>e.jsx(E,{className:"flex items-center gap-x-2",children:e.jsxs(V,{onValueChange:r=>{a.onChange(r),l()},defaultValue:a.value,children:[e.jsx(L,{children:e.jsx(T,{className:"h-10 rounded-full px-4 flex gap-x-2 !mt-0 w-[150px] text-left",children:e.jsx(O,{})})}),e.jsxs(A,{className:"flex-shrink-0 !mt-0",children:[e.jsx($,{strokeWidth:1.5,color:"#b9b9b9"})," "]}),e.jsx(G,{className:"",children:p.map(r=>e.jsx(q,{value:r.value,className:"",children:e.jsx("p",{className:"!bg-transparent",children:r.label})},r.value))})]})})})]})})}function K(){const{projectId:i}=j(),{query:n}=g(),{data:t,fetchNextPage:c,hasNextPage:o}=z(i,{...n,limit:10}),l=d.useMemo(()=>t?t==null?void 0:t.pages.flatMap(s=>s.todos):[],[t]);return e.jsx(R,{type:"single",collapsible:!0,children:e.jsx(B,{dataLength:l.length,next:c,hasMore:o,loader:e.jsx("div",{children:e.jsx(U,{})}),className:"w-full flex flex-col gap-y-3",children:l.map(s=>e.jsx(H,{todo:s},s._id))})})}function se(){const{projectId:i}=j(),{data:n}=Q({project_id:i}),{data:t}=W({project:i}),c=d.useMemo(()=>t?t.statusCount:null,[t]),o=d.useMemo(()=>{if(!c)return[];const l={complete:{order:0,value:0,color:"bg-[#41B06E]"},inprogress:{order:1,value:0,color:"bg-[#10439F]"}};return c.filter(s=>s.status!==u.TODO).forEach(s=>{s.status===u.CANCELED||s.status===u.COMPLETED?l.complete.value+=s.percentage:(s.status===u.IN_PROGRESS||s.status===u.PENDING)&&(l.inprogress.value+=s.percentage)}),Object.values(l)},[c]);return e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"w-full h-[150px] relative overflow-hidden flex justify-center items-center",style:{backgroundImage:`url("${n==null?void 0:n.imageCover}")`,backgroundSize:"cover",backgroundPosition:"center"},children:[e.jsx("div",{className:"absolute inset-0 bg-black/30 -z-1"}),e.jsx("h3",{className:"text-center font-bold text-2xl relative z-10 text-white",children:n==null?void 0:n.title})]}),e.jsx(_,{segments:o,className:"h-2 rounded-none"}),e.jsx("div",{className:"w-full  px-4 mt-3",children:e.jsx(J,{})}),e.jsx("div",{className:"p-4 ",children:e.jsx(K,{})})]})}export{se as default};
